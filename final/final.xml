<mujoco model="wheel_on_stick">
    <!-- Big picture: 2-axis sliding base + 2-DOF stick + reaction wheel, on uneven terrain. -->
    <!-- Reader Mode:
         - Dynamics (mass/collision critical): base cylinder, stick capsule, wheel rotor + hub, terrain, slide/hinge joints.
         - Visual-only (mass=0 and contype/conaffinity=0): chassis shell/plate, bumpers, dome, torso/head/eyes, rim/tire/spokes.
         - Controls: 3 motors -> wheel_spin torque, base_x_force, base_y_force.
         - Contact story: robot interacts with uneven ground tiles; deep_floor is only a hidden fail-safe catcher. -->
    <compiler angle="radian"/>
    <!-- Global physics settings: 1 kHz simulation and Earth gravity. -->
    <option timestep="0.001" gravity="0 0 -9.81"/>

    <asset>
        <!-- Skybox for environment lighting/background only. -->
        <texture name="sky" type="skybox" builtin="gradient" rgb1="0.55 0.72 0.92" rgb2="0.97 0.98 1.0" width="512" height="3072"/>
        <!-- Checker texture shared by terrain tiles. -->
        <texture name="ground_tex" type="2d" builtin="checker" rgb1="0.22 0.26 0.31" rgb2="0.17 0.20 0.24" width="512" height="512"/>
        <!-- Terrain material (visual + reflectance). -->
        <material name="ground_mat" texture="ground_tex" texrepeat="20 20" reflectance="0.12" specular="0.08" shininess="0.15"/>
        <!-- Blue base-wheel material. -->
        <material name="base_mat" rgba="0.16 0.56 0.94 1.0" specular="0.45" shininess="0.55"/>
        <!-- Main physical stick material. -->
        <material name="stick_mat" rgba="0.95 0.35 0.30 1.0" specular="0.32" shininess="0.40"/>
        <!-- Reaction wheel material. -->
        <material name="wheel_mat" rgba="0.80 0.64 0.40 1.0" specular="0.30" shininess="0.38"/>
        <!-- Hub/highlight material. -->
        <material name="hub_mat" rgba="0.98 0.95 0.25 1.0" specular="0.60" shininess="0.70"/>
        <!-- Dark chassis trim material. -->
        <material name="chassis_dark_mat" rgba="0.15 0.17 0.19 1.0" specular="0.65" shininess="0.85"/>
        <!-- Light chassis trim material. -->
        <material name="chassis_light_mat" rgba="0.46 0.52 0.58 1.0" specular="0.70" shininess="0.88"/>
        <!-- Accent/bumper trim material. -->
        <material name="trim_mat" rgba="0.98 0.42 0.20 1.0" specular="0.38" shininess="0.62"/>
        <!-- Visual tire/rubber material. -->
        <material name="rubber_mat" rgba="0.08 0.08 0.09 1.0" specular="0.05" shininess="0.10"/>
        <!-- Glass-like visual material for decorative sensors/eyes. -->
        <material name="sensor_glass_mat" rgba="0.22 0.76 0.96 0.75" specular="0.95" shininess="0.98"/>
    </asset>

    <visual>
        <!-- Camera clipping range. -->
        <map znear="0.001" zfar="50"/>
        <!-- Scene headlight. -->
        <headlight ambient="0.24 0.24 0.26" diffuse="0.62 0.62 0.62" specular="0.25 0.25 0.25"/>
        <!-- Atmospheric haze tint. -->
        <rgba haze="0.90 0.94 1.0 1"/>
    </visual>

    <worldbody>
        <!-- Key directional light for shape definition/shadows. -->
        <light name="sun_key"
               pos="4 -5 7"
               dir="-0.5 0.6 -1"
               directional="true"
               castshadow="true"
               diffuse="0.95 0.95 0.92"
               specular="0.20 0.20 0.20"/>
        <!-- Fill light to soften contrast. -->
        <light name="fill"
               pos="-4 3 3"
               directional="false"
               castshadow="false"
               diffuse="0.35 0.37 0.42"
               specular="0 0 0"/>

        <!-- Non-flat terrain: uneven tiles with small height/tilt changes -->
        <!-- Primary contact patch under spawn. -->
        <geom name="terrain_center" type="box" size="1.2 1.2 0.08" pos="0.0 0.0 -0.08" euler="0.03 -0.02 0.00" material="ground_mat" friction="2.2 0.03 0.001"/>
        <!-- North terrain tile to expand operating area. -->
        <geom name="terrain_n" type="box" size="1.2 1.2 0.08" pos="0.0 2.4 -0.06" euler="-0.02 0.01 0.00" material="ground_mat" friction="2.2 0.03 0.001"/>
        <!-- South terrain tile with slightly different height/tilt. -->
        <geom name="terrain_s" type="box" size="1.2 1.2 0.08" pos="0.0 -2.4 -0.09" euler="0.02 0.01 0.00" material="ground_mat" friction="2.2 0.03 0.001"/>
        <!-- East terrain tile for lateral diversity. -->
        <geom name="terrain_e" type="box" size="1.2 1.2 0.08" pos="2.4 0.0 -0.07" euler="-0.01 -0.03 0.00" material="ground_mat" friction="2.2 0.03 0.001"/>
        <!-- West terrain tile for lateral diversity. -->
        <geom name="terrain_w" type="box" size="1.2 1.2 0.08" pos="-2.4 0.0 -0.10" euler="0.01 0.03 0.00" material="ground_mat" friction="2.2 0.03 0.001"/>
        <!-- Northeast corner tile. -->
        <geom name="terrain_ne" type="box" size="1.2 1.2 0.08" pos="2.4 2.4 -0.05" euler="-0.02 -0.01 0.00" material="ground_mat" friction="2.2 0.03 0.001"/>
        <!-- Northwest corner tile. -->
        <geom name="terrain_nw" type="box" size="1.2 1.2 0.08" pos="-2.4 2.4 -0.11" euler="0.02 0.02 0.00" material="ground_mat" friction="2.2 0.03 0.001"/>
        <!-- Southeast corner tile. -->
        <geom name="terrain_se" type="box" size="1.2 1.2 0.08" pos="2.4 -2.4 -0.08" euler="-0.01 -0.02 0.00" material="ground_mat" friction="2.2 0.03 0.001"/>
        <!-- Southwest corner tile. -->
        <geom name="terrain_sw" type="box" size="1.2 1.2 0.08" pos="-2.4 -2.4 -0.12" euler="0.02 0.01 0.00" material="ground_mat" friction="2.2 0.03 0.001"/>
        <!-- Local unevenness at spawn region -->
        <!-- Spawn bump #1: localized disturbance source. -->
        <geom name="spawn_bump_1" type="box" size="0.16 0.16 0.02" pos="0.22 0.00 0.00" euler="0.06 0.00 0.00" material="ground_mat" friction="2.2 0.03 0.001"/>
        <!-- Spawn bump #2: mirrored unevenness. -->
        <geom name="spawn_bump_2" type="box" size="0.16 0.16 0.02" pos="-0.22 0.00 0.01" euler="-0.05 0.02 0.00" material="ground_mat" friction="2.2 0.03 0.001"/>
        <!-- Spawn bump #3: Y-axis irregularity. -->
        <geom name="spawn_bump_3" type="box" size="0.16 0.16 0.02" pos="0.00 0.22 0.005" euler="0.00 -0.06 0.00" material="ground_mat" friction="2.2 0.03 0.001"/>
        <!-- Spawn bump #4: opposite-side irregularity. -->
        <geom name="spawn_bump_4" type="box" size="0.16 0.16 0.02" pos="0.00 -0.22 -0.005" euler="0.02 0.05 0.00" material="ground_mat" friction="2.2 0.03 0.001"/>

        <!-- Safety catcher below terrain -->
        <!-- Invisible fail-safe floor to catch numerical blowups/falls. -->
        <geom name="deep_floor" type="plane" size="100 100 0.001" pos="0 0 -1.2" rgba="0 0 0 0" friction="2.0 0.02 0.001"/>

        <!-- Camera -->
        <!-- Default side camera for observing balancing behavior. -->
        <camera name="side"
                pos="0 -3.8 1.55"
                quat="0.9336 0.3584 0 0"/>

        <!-- Base cart X -->
        <body name="base_x" pos="0 0 0.075">
                <!-- Tiny inertial so moving base_x body remains physically valid. -->
                <inertial pos="0 0 0" mass="0.01" diaginertia="1e-6 1e-6 1e-6"/>

                <!-- First translational DOF: global X motion. -->
                <joint name="base_x_slide"
                       type="slide"
                       axis="1 0 0"
                   damping="1.2"
                   armature="0.02"
                   limited="true"
                   range="-5 5"/>

            <!-- Base cart Y -->
            <body name="base_y" pos="0 0 0.075">

                <!-- Second translational DOF: global Y motion. -->
                <joint name="base_y_slide"
                       type="slide"
                       axis="0 1 0"
                       damping="1.2"
                       armature="0.02"
                       limited="true"
                       range="-5 5"/>

                <!-- Cart body -->
                <!-- Main physical base-wheel/body geom for contact and inertia. -->
                <geom type="cylinder"
                      size="0.15 0.05"
                      mass="0.5"
                      quat="0.7071 0 0.7071 0"
                      material="base_mat"
                      friction="2.0 0.2 0.001"/>
                <!-- Visual chassis shell (no mass/collision contribution). -->
                <geom name="chassis_shell"
                      type="box"
                      size="0.18 0.13 0.035"
                      pos="0 0 0.175"
                      mass="0"
                      contype="0"
                      conaffinity="0"
                      material="chassis_dark_mat"/>
                <!-- Visual top panel (no mass/collision contribution). -->
                <geom name="chassis_top_plate"
                      type="box"
                      size="0.13 0.10 0.009"
                      pos="0 0 0.221"
                      mass="0"
                      contype="0"
                      conaffinity="0"
                      material="chassis_light_mat"/>
                <!-- Front decorative bumper bar. -->
                <geom name="front_bumper"
                      type="capsule"
                      fromto="0.13 0.10 0.095  0.13 -0.10 0.095"
                      size="0.012"
                      mass="0"
                      contype="0"
                      conaffinity="0"
                      material="trim_mat"/>
                <!-- Rear decorative bumper bar. -->
                <geom name="rear_bumper"
                      type="capsule"
                      fromto="-0.13 0.10 0.095  -0.13 -0.10 0.095"
                      size="0.012"
                      mass="0"
                      contype="0"
                      conaffinity="0"
                      material="chassis_light_mat"/>
                <!-- Decorative sensor dome (visual only). -->
                <geom name="base_sensor_dome"
                      type="sphere"
                      size="0.022"
                      pos="0 0 0.055"
                      mass="0"
                      contype="0"
                      conaffinity="0"
                      material="sensor_glass_mat"/>

                <!-- 2-DOF stick: pitch then roll -->
                <body name="stick_pitch_frame" pos="0 0 0.10">
                    <!-- Light frame inertia to keep pitch frame numerically well-behaved. -->
                    <inertial pos="0 0 0" mass="0.01" diaginertia="1e-5 1e-5 1e-5"/>

                    <!-- First stick rotational DOF: pitch. -->
                    <joint name="stick_pitch"
                           type="hinge"
                           axis="0 1 0"
                           range="-3.14 3.14"
                           damping="10.0"
                           armature="0.04"/>

                    <body name="stick" pos="0 0 0">

                        <!-- Second stick rotational DOF: roll. -->
                        <joint name="stick_roll"
                               type="hinge"
                               axis="1 0 0"
                               range="-3.14 3.14"
                               damping="12.0"
                               armature="0.04"/>

                        <!-- Main physical pendulum stick (mass-carrying). -->
                        <geom type="capsule"
                              fromto="0 0 0  0 0 0.50"
                              size="0.04"
                              mass="1.0"
                              material="stick_mat"/>
                        <!-- Visual torso fairing around the stick. -->
                        <geom name="torso_shell"
                              type="capsule"
                              fromto="0 0 0.03  0 0 0.44"
                              size="0.055"
                              mass="0"
                              contype="0"
                              conaffinity="0"
                              material="chassis_dark_mat"/>
                        <!-- Visual shoulder ring detail. -->
                        <geom name="shoulder_ring"
                              type="cylinder"
                              size="0.085 0.010"
                              pos="0 0 0.34"
                              mass="0"
                              contype="0"
                              conaffinity="0"
                              material="chassis_light_mat"/>
                        <!-- Visual head shell. -->
                        <geom name="head_shell"
                              type="sphere"
                              size="0.062"
                              pos="0 0 0.50"
                              mass="0"
                              contype="0"
                              conaffinity="0"
                              material="chassis_light_mat"/>
                        <!-- Visual left eye marker. -->
                        <geom name="eye_left"
                              type="sphere"
                              size="0.012"
                              pos="0.025 0.036 0.514"
                              mass="0"
                              contype="0"
                              conaffinity="0"
                              material="sensor_glass_mat"/>
                        <!-- Visual right eye marker. -->
                        <geom name="eye_right"
                              type="sphere"
                              size="0.012"
                              pos="0.025 -0.036 0.514"
                              mass="0"
                              contype="0"
                              conaffinity="0"
                              material="sensor_glass_mat"/>
                        <!-- Visual head band trim. -->
                        <geom name="head_band"
                              type="capsule"
                              fromto="0.018 0.052 0.500  0.018 -0.052 0.500"
                              size="0.008"
                              mass="0"
                              contype="0"
                              conaffinity="0"
                              material="trim_mat"/>

                        <!-- Reaction wheel -->
                        <body name="wheel" pos="0 0 0.35">

                            <!-- Wheel spin DOF: fast rotor for attitude control torque. -->
                            <joint name="wheel_spin"
                                   type="hinge"
                                   axis="0 1 0"
                                   damping="0.5"
                                   limited="false"/>

                            <!-- Physical reaction wheel rotor mass. -->
                            <geom type="cylinder"
                                  size="0.20 0.03"
                                  mass="0.8"
                                  quat="0.7071 0.7071 0 0"
                                  material="wheel_mat"/>
                            <!-- Visual wheel tire layer. -->
                            <geom name="wheel_tire"
                                  type="cylinder"
                                  size="0.225 0.022"
                                  quat="0.7071 0.7071 0 0"
                                  mass="0"
                                  contype="0"
                                  conaffinity="0"
                                  material="rubber_mat"/>
                            <!-- Visual wheel rim detail. -->
                            <geom name="wheel_rim"
                                  type="cylinder"
                                  size="0.172 0.018"
                                  quat="0.7071 0.7071 0 0"
                                  mass="0"
                                  contype="0"
                                  conaffinity="0"
                                  material="chassis_light_mat"/>
                            <!-- Visual spoke along local X. -->
                            <geom name="wheel_spoke_x"
                                  type="box"
                                  size="0.14 0.012 0.006"
                                  mass="0"
                                  contype="0"
                                  conaffinity="0"
                                  material="chassis_dark_mat"/>
                            <!-- Visual spoke along local Y. -->
                            <geom name="wheel_spoke_y"
                                  type="box"
                                  size="0.012 0.14 0.006"
                                  mass="0"
                                  contype="0"
                                  conaffinity="0"
                                  material="chassis_dark_mat"/>

                            <!-- Physical wheel hub mass near axis. -->
                            <geom type="sphere"
                                  size="0.05"
                                  material="hub_mat"/>
                            <!-- Visual hub cap detail. -->
                            <geom name="hub_cap"
                                  type="sphere"
                                  size="0.032"
                                  mass="0"
                                  contype="0"
                                  conaffinity="0"
                                  material="trim_mat"/>
                        </body>
                    </body>
                </body>
            </body>
        </body>
    </worldbody>

    <actuator>
        <!-- Motor command for wheel spin torque. -->
        <motor name="wheel_spin"
               joint="wheel_spin"
               ctrlrange="-2000 2000"/>

        <!-- Motor command for base X force. -->
        <motor name="base_x_force"
               joint="base_x_slide"
               ctrlrange="-500 500"/>

        <!-- Motor command for base Y force. -->
        <motor name="base_y_force"
               joint="base_y_slide"
               ctrlrange="-500 500"/>

    </actuator>
</mujoco>
