<mujoco model="wheel_on_stick">
    <compiler angle="radian"/>
    <option timestep="0.001" gravity="0 0 -9.81"/>

    <visual>
        <map znear="0.001" zfar="50"/>
    </visual>

    <worldbody>

        <!-- Ground -->
        <geom type="plane"
              size="100 100 0.001"
              rgba="0.95 0.95 1.0 1"
              friction="2.0 0.02 0.001"/>

        <!-- Camera -->
        <camera name="side"
                pos="0 -4 1.5"
                quat="0.9239 0.3827 0 0"/>

        <!-- Base cart X -->
        <body name="base_x" pos="0 0 0.075">

                <joint name="base_x_slide"
                       type="slide"
                       axis="1 0 0"
                   damping="1.2"
                   armature="0.02"
                   limited="true"
                   range="-5 5"/>

            <!-- Tiny marker -->
            <geom type="sphere"
                  size="0.01"
                  mass="0.01"
                  rgba="1 0 1 1"/>

            <!-- Base cart Y -->
            <body name="base_y" pos="0 0 0.075">

                <joint name="base_y_slide"
                       type="slide"
                       axis="0 1 0"
                       damping="1.2"
                       armature="0.02"
                       limited="true"
                       range="-5 5"/>

                <!-- Cart body -->
                <geom type="cylinder"
                      size="0.15 0.05"
                      mass="0.5"
                      quat="0.7071 0 0.7071 0"
                      rgba="0.2 0.6 1.0 1"
                      friction="2.0 0.2 0.001"/>

                <!-- 2-DOF stick: pitch then roll -->
                <body name="stick_pitch_frame" pos="0 0 0.10">
                    <inertial pos="0 0 0" mass="0.01" diaginertia="1e-5 1e-5 1e-5"/>

                    <joint name="stick_pitch"
                           type="hinge"
                           axis="0 1 0"
                           range="-3.14 3.14"
                           damping="10.0"
                           armature="0.04"/>

                    <body name="stick" pos="0 0 0">

                        <joint name="stick_roll"
                               type="hinge"
                               axis="1 0 0"
                               range="-3.14 3.14"
                               damping="12.0"
                               armature="0.04"/>

                        <geom type="capsule"
                              fromto="0 0 0  0 0 0.65"
                              size="0.04"
                              mass="1.0"
                              rgba="1.0 0.3 0.3 1"/>

                        <!-- Reaction wheel -->
                        <body name="wheel" pos="0 0 0.45">

                            <joint name="wheel_spin"
                                   type="hinge"
                                   axis="0 1 0"
                                   damping="0.5"
                                   limited="false"/>

                            <geom type="cylinder"
                                  size="0.20 0.03"
                                  mass="0.8"
                                  quat="0.7071 0.7071 0 0"
                                  rgba="0.8 0.6 0.4 1"/>

                            <geom type="sphere"
                                  size="0.05"
                                  rgba="1.0 1.0 0.2 1"/>
                        </body>
                    </body>
                </body>
            </body>
        </body>
    </worldbody>

    <actuator>
        <motor name="wheel_spin"
               joint="wheel_spin"
               ctrlrange="-2000 2000"/>

        <motor name="base_x_force"
               joint="base_x_slide"
               ctrlrange="-500 500"/>

        <motor name="base_y_force"
               joint="base_y_slide"
               ctrlrange="-500 500"/>

    </actuator>
</mujoco>
